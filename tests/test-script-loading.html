<!DOCTYPE html>
<html>
<head>
    <title>Script Loading Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: white; }
        .success { color: #00ff88; }
        .error { color: #ff6b6b; }
    </style>
</head>
<body>
    <h1>Testing Script Loading Order</h1>
    <div id="results"></div>

    <!-- Exact copy of script loading from newtab.html -->
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/dayjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/advancedFormat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dayjs@1/plugin/localizedFormat.js"></script>
    
    <script>
        const results = document.getElementById('results');
        
        // Test Day.js
        if (typeof dayjs !== 'undefined') {
            results.innerHTML += '<p class="success">✅ Day.js loaded</p>';
            
            // Test plugins
            if (window.dayjs_plugin_advancedFormat) {
                dayjs.extend(window.dayjs_plugin_advancedFormat);
                results.innerHTML += '<p class="success">✅ AdvancedFormat plugin loaded</p>';
            } else {
                results.innerHTML += '<p class="error">❌ AdvancedFormat plugin NOT loaded</p>';
            }
            
            if (window.dayjs_plugin_localizedFormat) {
                dayjs.extend(window.dayjs_plugin_localizedFormat);
                results.innerHTML += '<p class="success">✅ LocalizedFormat plugin loaded</p>';
            } else {
                results.innerHTML += '<p class="error">❌ LocalizedFormat plugin NOT loaded</p>';
            }
            
            // Test formatting
            const testFormat = dayjs().format('YYYY-MM-DD');
            results.innerHTML += `<p>Test format result: ${testFormat}</p>`;
            
        } else {
            results.innerHTML += '<p class="error">❌ Day.js NOT loaded</p>';
        }
    </script>
    
    <!-- Now load the extension scripts -->
    <script src="extension/settings.js"></script>
    <script src="extension/widgets.js"></script>
    
    <script>
        // Check if settings and widgets loaded
        setTimeout(() => {
            if (typeof settings !== 'undefined') {
                results.innerHTML += '<p class="success">✅ settings.js loaded</p>';
            } else {
                results.innerHTML += '<p class="error">❌ settings.js NOT loaded</p>';
            }
            
            if (typeof initWidgetsUI !== 'undefined') {
                results.innerHTML += '<p class="success">✅ widgets.js loaded</p>';
            } else {
                results.innerHTML += '<p class="error">❌ widgets.js NOT loaded</p>';
            }
        }, 100);
    </script>
</body>
</html>